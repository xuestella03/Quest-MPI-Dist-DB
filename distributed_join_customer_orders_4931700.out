Starting distributed join for customer and orders tables at Mon Jun  2 23:12:27 CDT 2025
Running on 2 nodes with 2 total tasks
Requirement already satisfied: duckdb in /gpfs/home/exy4679/.local/lib/python3.10/site-packages (1.3.0)
Requirement already satisfied: mpi4py in /gpfs/home/exy4679/.local/lib/python3.10/site-packages (4.0.3)
Successfully loaded modules and installed packages
[Coordinator] Created tables: customer, lineitem, nation, orders, part, partsupp, region, supplier
Orders records: 150000
Customer records: 15000
[Coordinator] Database file created successfully!
Finished uploading tpc-h file
============================================================
Distributed join customer and orders tables on 2 nodes
============================================================
Rank 0: Partitioning and distributing customer and orders Parquet files
Rank 1: Receiving customer and orders Parquet files...
Rank 0: Sent customer and orders partitions to rank 1
Rank 1: Received and saved Parquet files
Rank 0: Loaded 7500 customer and 75225 orders records into local DB
Rank 1: Loaded 7500 customer and 74775 orders records into local DB
Rank 0: Local join completed in 0:00:00.169514, found 75225 results
	First 5 rows are [(12332, 'Customer#000012332', 3, datetime.date(1993, 10, 14), Decimal('247296.05')), (13678, 'Customer#000013678', 4, datetime.date(1995, 10, 11), Decimal('53829.87')), (4450, 'Customer#000004450', 5, datetime.date(1994, 7, 30), Decimal('139660.54')), (3914, 'Customer#000003914', 7, datetime.date(1996, 1, 10), Decimal('231037.28')), (13006, 'Customer#000013006', 32, datetime.date(1995, 7, 16), Decimal('166802.63'))]
Starting optimized collection phase...
Rank 1: Local join completed in 0:00:00.177309, found 74775 results
	First 5 rows are [(3691, 'Customer#000003691', 1, datetime.date(1996, 1, 2), Decimal('194029.55')), (7801, 'Customer#000007801', 2, datetime.date(1996, 12, 1), Decimal('60951.63')), (5563, 'Customer#000005563', 6, datetime.date(1992, 2, 21), Decimal('65843.52')), (6697, 'Customer#000006697', 33, datetime.date(1993, 10, 27), Decimal('118518.56')), (6101, 'Customer#000006101', 34, datetime.date(1998, 7, 21), Decimal('75662.77'))]
Total records to collect: 150000
Receiving results from rank 1...
Collection completed in 0:02:38.018875
Saved merged results to data/joined_results.parquet
Total execution time: 159.027959 seconds
Partitioning time: 0.819658 seconds
Local join time: 0.169621 seconds
Collection time: 158.037459 seconds
Distributed join for customer and orders tables finished at 
